<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    
    <title>Consensus | Lyfebloc Docs</title>
    <meta name="description" content="Highly scalable modular blockchain powering dynamic applications with extensive full-stack adaptability.">
    <link rel="preload stylesheet" href="/assets/style.e3b0a222.css" as="style">
    
    <script type="module" src="/assets/app.305f46fa.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.1a91c06a.js">
    <link rel="modulepreload" href="/assets/chunks/theme.0fcea326.js">
    <link rel="modulepreload" href="/assets/architecture_consensus.md.659bcfce.lean.js">
    <link rel="icon" href="/favicons/favicon.svg" type="image/svg+xml">
    <link rel="icon" href="/favicons/favicon.png" type="image/png">
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <meta name="msapplication-TileColor" content="#fff">
    <meta name="theme-color" content="#fff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta property="description" content="Lyfebloc Network is a highly scalable modular blockchain powering dynamic applications with extensive full-stack adaptability..">
    <meta httpEquiv="Content-Language" content="en">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@lyfeblocnetwork">
    <meta name="twitter:site:domain" content="docs.lyfebloc.network">
    <meta name="twitter:url" content="https://docs.lyfebloc.network">
    <meta name="twitter:image" content="">
    <meta name="twitter:image:alt" content="Lyfebloc Documentation">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Lyfebloc Docs">
    <meta property="og:url" content="https://docs.lyfebloc.network">
    <meta property="og:image" content="/Network-og.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/png">
    <meta name="apple-mobile-web-app-title" content="Lyfebloc Network">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta property="og:title" content="Consensus | Lyfebloc Docs">
    <meta property="og:description" content="Lyfebloc Network is a highly scalable modular blockchain powering dynamic applications with extensive full-stack adaptability.">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-9d8abc1e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-9d8abc1e data-v-7ad780c2><div class="VPNavBar has-sidebar" data-v-7ad780c2 data-v-f1abbc6e><div class="container" data-v-f1abbc6e><div class="title" data-v-f1abbc6e><div class="VPNavBarTitle has-sidebar" data-v-f1abbc6e data-v-2973dbb4><a class="title" href="/" data-v-2973dbb4><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/logo-dark.svg" alt="Lyfebloc Logo" data-v-ab19afbb><!--]--><!--[--><img class="VPImage light logo" src="/logo-light.svg" alt="Lyfebloc Logo" data-v-ab19afbb><!--]--><!--]--><!--]--><!----><!--[--><!--]--></a></div></div><div class="content" data-v-f1abbc6e><div class="curtain" data-v-f1abbc6e></div><div class="content-body" data-v-f1abbc6e><!--[--><!--]--><div class="VPNavBarSearch search" data-v-f1abbc6e><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-f1abbc6e data-v-f732b5d0><span id="main-nav-aria-label" class="visually-hidden" data-v-f732b5d0>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f732b5d0 data-v-aa8de344><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-aa8de344><span class="text" data-v-aa8de344><!----><span data-v-aa8de344>Join the network</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-aa8de344><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-aa8de344><div class="VPMenu" data-v-aa8de344 data-v-e42ed9b3><div class="items" data-v-e42ed9b3><!--[--><!--[--><div class="VPMenuLink" data-v-e42ed9b3 data-v-f51f088d><a class="VPLink link" href="/overview/introduction" data-v-f51f088d><!--[-->Overview<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e42ed9b3 data-v-f51f088d><a class="VPLink link" href="/get-started/installation" data-v-f51f088d><!--[-->Installation<!--]--></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-e42ed9b3 data-v-a6b0397c><p class="title" data-v-a6b0397c>Resources</p><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link vp-external-link-icon" href="https://lyfeblocscan.com/" target="_blank" rel="noreferrer" data-v-f51f088d><!--[-->Lyfebloc Network Explorer<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-f51f088d><a class="VPLink link" href="/get-started/api-docs" data-v-f51f088d><!--[-->lyfebloc-core API docs<!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-f1abbc6e data-v-283b26e9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-283b26e9 data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-f1abbc6e data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lyfeblocnetwork/docs" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://twitter.com/LyfeblocNetwork" aria-label="twitter" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636 0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94 0 0 1 0 19.539a9.88 9.88 0 0 0 7.287-2.041 4.93 4.93 0 0 1-4.6-3.42 4.916 4.916 0 0 0 2.223-.084A4.926 4.926 0 0 1 .96 9.167v-.062a4.887 4.887 0 0 0 2.235.616A4.928 4.928 0 0 1 1.67 3.148 13.98 13.98 0 0 0 11.82 8.292a4.929 4.929 0 0 1 8.39-4.49 9.868 9.868 0 0 0 3.128-1.196 4.941 4.941 0 0 1-2.165 2.724A9.828 9.828 0 0 0 24 4.555a10.019 10.019 0 0 1-2.457 2.549z"/></svg></a><a class="VPSocialLink no-icon" href="https://discord.com" aria-label="discord" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><a class="VPSocialLink no-icon" href="https://t.me" aria-label target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12ZM12.43 8.85893C11.2628 9.3444 8.93014 10.3492 5.43189 11.8733C4.86383 12.0992 4.56626 12.3202 4.53917 12.5363C4.49339 12.9015 4.95071 13.0453 5.57347 13.2411C5.65818 13.2678 5.74595 13.2954 5.83594 13.3246C6.44864 13.5238 7.27283 13.7568 7.70129 13.766C8.08994 13.7744 8.52373 13.6142 9.00264 13.2853C12.2712 11.079 13.9584 9.96381 14.0643 9.93977C14.139 9.92281 14.2426 9.90148 14.3128 9.96385C14.3829 10.0262 14.376 10.1443 14.3686 10.176C14.3233 10.3691 12.5281 12.0381 11.5991 12.9018C11.3095 13.171 11.1041 13.362 11.0621 13.4056C10.968 13.5033 10.8721 13.5958 10.78 13.6846C10.2108 14.2333 9.78391 14.6448 10.8036 15.3168C11.2936 15.6397 11.6858 15.9067 12.077 16.1731C12.5042 16.4641 12.9303 16.7543 13.4816 17.1157C13.6221 17.2077 13.7562 17.3034 13.8869 17.3965C14.3841 17.751 14.8307 18.0694 15.3826 18.0186C15.7032 17.9891 16.0345 17.6876 16.2027 16.7884C16.6002 14.6631 17.3816 10.0585 17.5622 8.16097C17.578 7.99473 17.5581 7.78197 17.5422 7.68857C17.5262 7.59518 17.4928 7.46211 17.3714 7.3636C17.2276 7.24694 17.0056 7.22234 16.9064 7.22408C16.455 7.23203 15.7626 7.47282 12.43 8.85893Z" fill="currentColor"/>
</svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-f1abbc6e data-v-c8c2ae4b data-v-aa8de344><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aa8de344><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aa8de344><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aa8de344><div class="VPMenu" data-v-aa8de344 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-c8c2ae4b><div class="item appearance" data-v-c8c2ae4b><p class="label" data-v-c8c2ae4b>Appearance</p><div class="appearance-action" data-v-c8c2ae4b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-c8c2ae4b data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-c8c2ae4b><div class="item social-links" data-v-c8c2ae4b><div class="VPSocialLinks social-links-list" data-v-c8c2ae4b data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lyfeblocnetwork/docs" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://twitter.com/LyfeblocNetwork" aria-label="twitter" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636 0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94 0 0 1 0 19.539a9.88 9.88 0 0 0 7.287-2.041 4.93 4.93 0 0 1-4.6-3.42 4.916 4.916 0 0 0 2.223-.084A4.926 4.926 0 0 1 .96 9.167v-.062a4.887 4.887 0 0 0 2.235.616A4.928 4.928 0 0 1 1.67 3.148 13.98 13.98 0 0 0 11.82 8.292a4.929 4.929 0 0 1 8.39-4.49 9.868 9.868 0 0 0 3.128-1.196 4.941 4.941 0 0 1-2.165 2.724A9.828 9.828 0 0 0 24 4.555a10.019 10.019 0 0 1-2.457 2.549z"/></svg></a><a class="VPSocialLink no-icon" href="https://discord.com" aria-label="discord" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"/></svg></a><a class="VPSocialLink no-icon" href="https://t.me" aria-label target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12ZM12.43 8.85893C11.2628 9.3444 8.93014 10.3492 5.43189 11.8733C4.86383 12.0992 4.56626 12.3202 4.53917 12.5363C4.49339 12.9015 4.95071 13.0453 5.57347 13.2411C5.65818 13.2678 5.74595 13.2954 5.83594 13.3246C6.44864 13.5238 7.27283 13.7568 7.70129 13.766C8.08994 13.7744 8.52373 13.6142 9.00264 13.2853C12.2712 11.079 13.9584 9.96381 14.0643 9.93977C14.139 9.92281 14.2426 9.90148 14.3128 9.96385C14.3829 10.0262 14.376 10.1443 14.3686 10.176C14.3233 10.3691 12.5281 12.0381 11.5991 12.9018C11.3095 13.171 11.1041 13.362 11.0621 13.4056C10.968 13.5033 10.8721 13.5958 10.78 13.6846C10.2108 14.2333 9.78391 14.6448 10.8036 15.3168C11.2936 15.6397 11.6858 15.9067 12.077 16.1731C12.5042 16.4641 12.9303 16.7543 13.4816 17.1157C13.6221 17.2077 13.7562 17.3034 13.8869 17.3965C14.3841 17.751 14.8307 18.0694 15.3826 18.0186C15.7032 17.9891 16.0345 17.6876 16.2027 16.7884C16.6002 14.6631 17.3816 10.0585 17.5622 8.16097C17.578 7.99473 17.5581 7.78197 17.5422 7.68857C17.5262 7.59518 17.4928 7.46211 17.3714 7.3636C17.2276 7.24694 17.0056 7.22234 16.9064 7.22408C16.455 7.23203 15.7626 7.47282 12.43 8.85893Z" fill="currentColor"/>
</svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-f1abbc6e data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-9d8abc1e data-v-9e669cc1><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-9e669cc1><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-9e669cc1><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-9e669cc1>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-9e669cc1 data-v-24251f6f><button data-v-24251f6f>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-9d8abc1e data-v-ee2efba5><div class="curtain" data-v-ee2efba5></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ee2efba5><span class="visually-hidden" id="sidebar-aria-label" data-v-ee2efba5> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible collapsed" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Overview</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h3 class="text" data-v-bd01e0d5>Network Overview</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/overview/introduction" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Introduction</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h3 class="text" data-v-bd01e0d5>LYB</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/overview/lyb" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Overview of LYB</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/overview/how-to-stake-lyb" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>How to stake LYB</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/overview/staking" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Staking dashboards</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible collapsed" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>How-to guides</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h3 class="text" data-v-bd01e0d5>Run a Node</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h4 class="text" data-v-bd01e0d5>Getting Started</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/installation" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/environment" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Local Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/cloud-setup" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Cloud Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/cli-commands" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>CLI Commands</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/rpc-commands" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>RPC Commands</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h4 class="text" data-v-bd01e0d5>Network Endpoints</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/json-rpc" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>JSON RPC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/operator-information" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Operator Info</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/backup-restore" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Backup/Restore</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h4 class="text" data-v-bd01e0d5>Consensus</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><section class="VPSidebarItem level-3 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h5 class="text" data-v-bd01e0d5>Lyfebloc Proof of Stake (POS)</h5><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-4 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/pos-concepts" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>POS Concepts</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-4 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/pos-setup" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>POS Contract Setup</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h3 class="text" data-v-bd01e0d5>Configuration</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/sample-config" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Server Config File</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/private-keys" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Manage private keys</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/get-started/metrics" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Enable Metrics</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible has-active" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Architecture</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h3 class="text" data-v-bd01e0d5>Overview</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/overview" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Overview</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible has-active" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h3 class="text" data-v-bd01e0d5>Modules</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/blockchain" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Blockchain</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/consensus" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Consensus</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/protocol" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Protocol</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/minimal" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Minimal</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/networking" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Networking</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/json-rpc" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>JSON RPC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/sealer" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Sealer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/storage" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Storage</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/types" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/txpool" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>TxPool</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/architecture/other" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Other Modules</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible collapsed" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Concepts</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/concepts/evm" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>EVM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/concepts/evm-state" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>EVM State</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible collapsed" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Performance Reports</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/performance-reports/overview" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/performance-reports/stress-testing" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Testing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/concepts/evm-state" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>EVM State</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-9d8abc1e data-v-3cf691b6><div class="VPDoc has-sidebar has-aside" data-v-3cf691b6 data-v-a3c25e27><!--[--><!--]--><div class="container" data-v-a3c25e27><div class="aside" data-v-a3c25e27><div class="aside-curtain" data-v-a3c25e27></div><div class="aside-container" data-v-a3c25e27><div class="aside-content" data-v-a3c25e27><div class="VPDocAside" data-v-a3c25e27 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-cb998dce data-v-3a6c4994><div class="content" data-v-3a6c4994><div class="outline-marker" data-v-3a6c4994></div><div class="outline-title" role="heading" aria-level="2" data-v-3a6c4994>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-3a6c4994><span class="visually-hidden" id="doc-outline-aria-label" data-v-3a6c4994> Table of Contents for current page </span><ul class="root" data-v-3a6c4994 data-v-463da30f><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a3c25e27><div class="content-container" data-v-a3c25e27><!--[--><!--]--><!----><main class="main" data-v-a3c25e27><div style="position:relative;" class="vp-doc _architecture_consensus" data-v-a3c25e27><div><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The <strong>Consensus</strong> module provides an interface for consensus mechanisms.</p><p>Lyfebloc Network uses the most efficient blockchain consensus protocol</p><ul><li><strong>Lyfebloc PoS</strong></li></ul><p>Lyfebloc Network wants to maintain a state of modularity and pluggability. <br> This is why the core consensus logic has been abstracted away, so new consensus mechanisms can be built on top, without compromising on usability and ease of use.</p><h2 id="consensus-interface" tabindex="-1">Consensus Interface <a class="header-anchor" href="#consensus-interface" aria-label="Permalink to &quot;Consensus Interface&quot;">​</a></h2><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// Consensus is the interface for consensus</span></span>
<span class="line"><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Consensus</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// VerifyHeader verifies the header is correct</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">VerifyHeader</span><span style="color:#E1E4E8;">(parent, header </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">types.Header) </span><span style="color:#F97583;">error</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// Start starts the consensus</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">Start</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">error</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// Close closes the connection</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">Close</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">error</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// Consensus is the interface for consensus</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Consensus</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// VerifyHeader verifies the header is correct</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">VerifyHeader</span><span style="color:#24292E;">(parent, header </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">types.Header) </span><span style="color:#D73A49;">error</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// Start starts the consensus</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">Start</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">error</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// Close closes the connection</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">Close</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">error</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>The <em><strong>Consensus</strong></em> interface is the core of the mentioned abstraction. <br></p><ul><li>The <strong>VerifyHeader</strong> method represents a helper function which the consensus layer exposes to the <strong>blockchain</strong> layer It is there to handle header verification</li><li>The <strong>Start</strong> method simply starts the consensus process, and everything associated with it. This includes synchronization, sealing, everything that needs to be done</li><li>The <strong>Close</strong> method closes the consensus connection</li></ul><h2 id="consensus-configuration" tabindex="-1">Consensus Configuration <a class="header-anchor" href="#consensus-configuration" aria-label="Permalink to &quot;Consensus Configuration&quot;">​</a></h2><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// Config is the configuration for the consensus</span></span>
<span class="line"><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Config</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// Logger to be used by the backend</span></span>
<span class="line"><span style="color:#E1E4E8;">	Logger </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">log.Logger</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// Params are the params of the chain and the consensus</span></span>
<span class="line"><span style="color:#E1E4E8;">	Params </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">chain.Params</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// Specific configuration parameters for the backend</span></span>
<span class="line"><span style="color:#E1E4E8;">	Config </span><span style="color:#F97583;">map</span><span style="color:#E1E4E8;">[</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// Path for the consensus protocol to store information</span></span>
<span class="line"><span style="color:#E1E4E8;">	Path </span><span style="color:#F97583;">string</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// Config is the configuration for the consensus</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Config</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// Logger to be used by the backend</span></span>
<span class="line"><span style="color:#24292E;">	Logger </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">log.Logger</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// Params are the params of the chain and the consensus</span></span>
<span class="line"><span style="color:#24292E;">	Params </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">chain.Params</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// Specific configuration parameters for the backend</span></span>
<span class="line"><span style="color:#24292E;">	Config </span><span style="color:#D73A49;">map</span><span style="color:#24292E;">[</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">interface</span><span style="color:#24292E;">{}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// Path for the consensus protocol to store information</span></span>
<span class="line"><span style="color:#24292E;">	Path </span><span style="color:#D73A49;">string</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>There may be times when you might want to pass in a custom location for the consensus protocol to store data, or perhaps a custom key-value map that you want the consensus mechanism to use. This can be achieved through the <em><strong>Config</strong></em> struct, which gets read when a new consensus instance is created.</p><h2 id="ibft" tabindex="-1">IBFT <a class="header-anchor" href="#ibft" aria-label="Permalink to &quot;IBFT&quot;">​</a></h2><h3 id="extradata" tabindex="-1">ExtraData <a class="header-anchor" href="#extradata" aria-label="Permalink to &quot;ExtraData&quot;">​</a></h3><p>The blockchain header object, among other fields, has a field called <strong>ExtraData</strong>. <br> To review the fields present in the block header, please check out the <strong><a href="/docs/concepts/ethereum-state#blocks">State in Ethereum</a></strong> section.</p><p>IBFT uses this extra field to store operational information regarding the block, answering questions like:</p><ul><li>&quot;Who signed this block?&quot;</li><li>&quot;Who are the validators for this block?&quot;</li></ul><p>These extra fields for IBFT are defined as follows:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IstanbulExtra</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	Validators    []types.Address</span></span>
<span class="line"><span style="color:#E1E4E8;">	Seal          []</span><span style="color:#F97583;">byte</span></span>
<span class="line"><span style="color:#E1E4E8;">	CommittedSeal [][]</span><span style="color:#F97583;">byte</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IstanbulExtra</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	Validators    []types.Address</span></span>
<span class="line"><span style="color:#24292E;">	Seal          []</span><span style="color:#D73A49;">byte</span></span>
<span class="line"><span style="color:#24292E;">	CommittedSeal [][]</span><span style="color:#D73A49;">byte</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="signing-data" tabindex="-1">Signing Data <a class="header-anchor" href="#signing-data" aria-label="Permalink to &quot;Signing Data&quot;">​</a></h3><p>In order for the node to sign information in IBFT, it leverages the <em>signHash</em> method:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">signHash</span><span style="color:#E1E4E8;">(h </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">types.Header) ([]</span><span style="color:#F97583;">byte</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//hash := istambulHeaderHash(h)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//return hash.Bytes(), nil</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	h </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> h.</span><span style="color:#79B8FF;">Copy</span><span style="color:#E1E4E8;">() </span><span style="color:#6A737D;">// make a copy since we update the extra field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	arena </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> fastrlp.DefaultArenaPool.</span><span style="color:#79B8FF;">Get</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">defer</span><span style="color:#E1E4E8;"> fastrlp.DefaultArenaPool.</span><span style="color:#79B8FF;">Put</span><span style="color:#E1E4E8;">(arena)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// when hashign the block for signing we have to remove from</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// the extra field the seal and commitedseal items</span></span>
<span class="line"><span style="color:#E1E4E8;">	extra, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">getIbftExtra</span><span style="color:#E1E4E8;">(h)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;">, err</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">putIbftExtraValidators</span><span style="color:#E1E4E8;">(h, extra.Validators)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	vv </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> arena.</span><span style="color:#79B8FF;">NewArray</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.ParentHash.</span><span style="color:#79B8FF;">Bytes</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.Sha3Uncles.</span><span style="color:#79B8FF;">Bytes</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.Miner.</span><span style="color:#79B8FF;">Bytes</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.StateRoot.</span><span style="color:#79B8FF;">Bytes</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.TxRoot.</span><span style="color:#79B8FF;">Bytes</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.ReceiptsRoot.</span><span style="color:#79B8FF;">Bytes</span><span style="color:#E1E4E8;">()))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewBytes</span><span style="color:#E1E4E8;">(h.LogsBloom[:]))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewUint</span><span style="color:#E1E4E8;">(h.Difficulty))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewUint</span><span style="color:#E1E4E8;">(h.Number))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewUint</span><span style="color:#E1E4E8;">(h.GasLimit))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewUint</span><span style="color:#E1E4E8;">(h.GasUsed))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewUint</span><span style="color:#E1E4E8;">(h.Timestamp))</span></span>
<span class="line"><span style="color:#E1E4E8;">	vv.</span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">(arena.</span><span style="color:#79B8FF;">NewCopyBytes</span><span style="color:#E1E4E8;">(h.ExtraData))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	buf </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> keccak.</span><span style="color:#79B8FF;">Keccak256Rlp</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;">, vv)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> buf, </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">func</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">signHash</span><span style="color:#24292E;">(h </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">types.Header) ([]</span><span style="color:#D73A49;">byte</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">error</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//hash := istambulHeaderHash(h)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//return hash.Bytes(), nil</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	h </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> h.</span><span style="color:#005CC5;">Copy</span><span style="color:#24292E;">() </span><span style="color:#6A737D;">// make a copy since we update the extra field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	arena </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> fastrlp.DefaultArenaPool.</span><span style="color:#005CC5;">Get</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">defer</span><span style="color:#24292E;"> fastrlp.DefaultArenaPool.</span><span style="color:#005CC5;">Put</span><span style="color:#24292E;">(arena)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// when hashign the block for signing we have to remove from</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// the extra field the seal and commitedseal items</span></span>
<span class="line"><span style="color:#24292E;">	extra, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">getIbftExtra</span><span style="color:#24292E;">(h)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;">, err</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">putIbftExtraValidators</span><span style="color:#24292E;">(h, extra.Validators)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	vv </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> arena.</span><span style="color:#005CC5;">NewArray</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.ParentHash.</span><span style="color:#005CC5;">Bytes</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.Sha3Uncles.</span><span style="color:#005CC5;">Bytes</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.Miner.</span><span style="color:#005CC5;">Bytes</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.StateRoot.</span><span style="color:#005CC5;">Bytes</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.TxRoot.</span><span style="color:#005CC5;">Bytes</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.ReceiptsRoot.</span><span style="color:#005CC5;">Bytes</span><span style="color:#24292E;">()))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewBytes</span><span style="color:#24292E;">(h.LogsBloom[:]))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewUint</span><span style="color:#24292E;">(h.Difficulty))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewUint</span><span style="color:#24292E;">(h.Number))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewUint</span><span style="color:#24292E;">(h.GasLimit))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewUint</span><span style="color:#24292E;">(h.GasUsed))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewUint</span><span style="color:#24292E;">(h.Timestamp))</span></span>
<span class="line"><span style="color:#24292E;">	vv.</span><span style="color:#005CC5;">Set</span><span style="color:#24292E;">(arena.</span><span style="color:#005CC5;">NewCopyBytes</span><span style="color:#24292E;">(h.ExtraData))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	buf </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> keccak.</span><span style="color:#005CC5;">Keccak256Rlp</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">nil</span><span style="color:#24292E;">, vv)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> buf, </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Another notable method is the <em>VerifyCommittedFields</em> method, which verifies that the committed seals are from valid validators:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">verifyCommitedFields</span><span style="color:#E1E4E8;">(snap </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Snapshot, header </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">types.Header) </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	extra, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">getIbftExtra</span><span style="color:#E1E4E8;">(header)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(extra.CommittedSeal) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;empty committed seals&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// get the message that needs to be signed</span></span>
<span class="line"><span style="color:#E1E4E8;">	signMsg, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">signHash</span><span style="color:#E1E4E8;">(header)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	signMsg </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">commitMsg</span><span style="color:#E1E4E8;">(signMsg)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	visited </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">map</span><span style="color:#E1E4E8;">[types.Address]</span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;">{}{}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> _, seal </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">range</span><span style="color:#E1E4E8;"> extra.CommittedSeal {</span></span>
<span class="line"><span style="color:#E1E4E8;">		addr, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ecrecoverImpl</span><span style="color:#E1E4E8;">(seal, signMsg)</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> _, ok </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> visited[addr]; ok {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;repeated seal&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">		} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">snap.Set.</span><span style="color:#79B8FF;">Includes</span><span style="color:#E1E4E8;">(addr) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;signed by non validator&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">			visited[addr] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;">{}{}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	validSeals </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(visited)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> validSeals </span><span style="color:#F97583;">&lt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">snap.Set.</span><span style="color:#79B8FF;">MinFaultyNodes</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;not enough seals to seal block&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">func</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">verifyCommitedFields</span><span style="color:#24292E;">(snap </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Snapshot, header </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">types.Header) </span><span style="color:#D73A49;">error</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	extra, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">getIbftExtra</span><span style="color:#24292E;">(header)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(extra.CommittedSeal) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;empty committed seals&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// get the message that needs to be signed</span></span>
<span class="line"><span style="color:#24292E;">	signMsg, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">signHash</span><span style="color:#24292E;">(header)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	signMsg </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">commitMsg</span><span style="color:#24292E;">(signMsg)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	visited </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">map</span><span style="color:#24292E;">[types.Address]</span><span style="color:#D73A49;">struct</span><span style="color:#24292E;">{}{}</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> _, seal </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">range</span><span style="color:#24292E;"> extra.CommittedSeal {</span></span>
<span class="line"><span style="color:#24292E;">		addr, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ecrecoverImpl</span><span style="color:#24292E;">(seal, signMsg)</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> _, ok </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> visited[addr]; ok {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;repeated seal&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">		} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">snap.Set.</span><span style="color:#005CC5;">Includes</span><span style="color:#24292E;">(addr) {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;signed by non validator&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">			visited[addr] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;">{}{}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	validSeals </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(visited)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> validSeals </span><span style="color:#D73A49;">&lt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">snap.Set.</span><span style="color:#005CC5;">MinFaultyNodes</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;not enough seals to seal block&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="snapshots" tabindex="-1">Snapshots <a class="header-anchor" href="#snapshots" aria-label="Permalink to &quot;Snapshots&quot;">​</a></h3><p>Snapshots, as the name implies, are there to provide a <em>snapshot</em>, or the <em>state</em> of a system at any block height (number).</p><p>Snapshots contain a set of nodes who are validators, as well as voting information (validators can vote for other validators). Validators include voting information in the <strong>Miner</strong> header filed, and change the value of the <strong>nonce</strong>:</p><ul><li>Nonce is <strong>all 1s</strong> if the node wants to remove a validator</li><li>Nonce is <strong>all 0s</strong> if the node wants to add a validator</li></ul><p>Snapshots are calculated using the <em><strong>processHeaders</strong></em> method:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Ibft) </span><span style="color:#B392F0;">processHeaders</span><span style="color:#E1E4E8;">(headers []</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">types.Header) </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(headers) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	parentSnap, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> i.</span><span style="color:#79B8FF;">getSnapshot</span><span style="color:#E1E4E8;">(headers[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">].Number </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">	snap </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> parentSnap.</span><span style="color:#79B8FF;">Copy</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	saveSnap </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">func</span><span style="color:#E1E4E8;">(h </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">types.Header) </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> snap.</span><span style="color:#79B8FF;">Equal</span><span style="color:#E1E4E8;">(parentSnap) {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		snap.Number </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> h.Number</span></span>
<span class="line"><span style="color:#E1E4E8;">		snap.Hash </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> h.Hash.</span><span style="color:#79B8FF;">String</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		i.store.</span><span style="color:#79B8FF;">add</span><span style="color:#E1E4E8;">(snap)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		parentSnap </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> snap</span></span>
<span class="line"><span style="color:#E1E4E8;">		snap </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> parentSnap.</span><span style="color:#79B8FF;">Copy</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> _, h </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">range</span><span style="color:#E1E4E8;"> headers {</span></span>
<span class="line"><span style="color:#E1E4E8;">		number </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> h.Number</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		validator, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ecrecoverFromHeader</span><span style="color:#E1E4E8;">(h)</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">snap.Set.</span><span style="color:#79B8FF;">Includes</span><span style="color:#E1E4E8;">(validator) {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;unauthroized validator&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> number</span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;">i.epochSize </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// during a checkpoint block, we reset the voles</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// and there cannot be any proposals</span></span>
<span class="line"><span style="color:#E1E4E8;">			snap.Votes </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">saveSnap</span><span style="color:#E1E4E8;">(h); err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// remove in-memory snaphots from two epochs before this one</span></span>
<span class="line"><span style="color:#E1E4E8;">			epoch </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">int</span><span style="color:#E1E4E8;">(number</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">i.epochSize) </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> epoch </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				purgeBlock </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">uint64</span><span style="color:#E1E4E8;">(epoch) </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> i.epochSize</span></span>
<span class="line"><span style="color:#E1E4E8;">				i.store.</span><span style="color:#79B8FF;">deleteLower</span><span style="color:#E1E4E8;">(purgeBlock)</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">continue</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">// if we have a miner address, this might be a vote</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> h.Miner </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> types.ZeroAddress {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">continue</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">// the nonce selects the action</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> authorize </span><span style="color:#F97583;">bool</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> h.Nonce </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> nonceAuthVote {</span></span>
<span class="line"><span style="color:#E1E4E8;">			authorize </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">		} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> h.Nonce </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> nonceDropVote {</span></span>
<span class="line"><span style="color:#E1E4E8;">			authorize </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#E1E4E8;">		} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;incorrect vote nonce&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">// validate the vote</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> authorize {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// we can only authorize if they are not on the validators list</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> snap.Set.</span><span style="color:#79B8FF;">Includes</span><span style="color:#E1E4E8;">(h.Miner) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">continue</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// we can only remove if they are part of the validators list</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">snap.Set.</span><span style="color:#79B8FF;">Includes</span><span style="color:#E1E4E8;">(h.Miner) {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">continue</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		count </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> snap.</span><span style="color:#79B8FF;">Count</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">func</span><span style="color:#E1E4E8;">(v </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Vote) </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> v.Validator </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> validator </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> v.Address </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> h.Miner</span></span>
<span class="line"><span style="color:#E1E4E8;">		})</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> count </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// there can only be one vote per validator per address</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> fmt.</span><span style="color:#79B8FF;">Errorf</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;more than one proposal per validator per address found&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> count </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// cast the new vote since there is no one yet</span></span>
<span class="line"><span style="color:#E1E4E8;">			snap.Votes </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">append</span><span style="color:#E1E4E8;">(snap.Votes, </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">Vote{</span></span>
<span class="line"><span style="color:#E1E4E8;">				Validator: validator,</span></span>
<span class="line"><span style="color:#E1E4E8;">				Address:   h.Miner,</span></span>
<span class="line"><span style="color:#E1E4E8;">				Authorize: authorize,</span></span>
<span class="line"><span style="color:#E1E4E8;">			})</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">// check the tally for the proposed validator</span></span>
<span class="line"><span style="color:#E1E4E8;">		tally </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> snap.</span><span style="color:#79B8FF;">Count</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">func</span><span style="color:#E1E4E8;">(v </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Vote) </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> v.Address </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> h.Miner</span></span>
<span class="line"><span style="color:#E1E4E8;">		})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> tally </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> snap.Set.</span><span style="color:#79B8FF;">Len</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">/</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> authorize {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#6A737D;">// add the proposal to the validator list</span></span>
<span class="line"><span style="color:#E1E4E8;">				snap.Set.</span><span style="color:#79B8FF;">Add</span><span style="color:#E1E4E8;">(h.Miner)</span></span>
<span class="line"><span style="color:#E1E4E8;">			} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#6A737D;">// remove the proposal from the validators list</span></span>
<span class="line"><span style="color:#E1E4E8;">				snap.Set.</span><span style="color:#79B8FF;">Del</span><span style="color:#E1E4E8;">(h.Miner)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#6A737D;">// remove any votes casted by the removed validator</span></span>
<span class="line"><span style="color:#E1E4E8;">				snap.</span><span style="color:#79B8FF;">RemoveVotes</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">func</span><span style="color:#E1E4E8;">(v </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Vote) </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">					</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> v.Validator </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> h.Miner</span></span>
<span class="line"><span style="color:#E1E4E8;">				})</span></span>
<span class="line"><span style="color:#E1E4E8;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// remove all the votes that promoted this validator</span></span>
<span class="line"><span style="color:#E1E4E8;">			snap.</span><span style="color:#79B8FF;">RemoveVotes</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">func</span><span style="color:#E1E4E8;">(v </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Vote) </span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">				</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> v.Address </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> h.Miner</span></span>
<span class="line"><span style="color:#E1E4E8;">			})</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">saveSnap</span><span style="color:#E1E4E8;">(h); err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// update the metadata</span></span>
<span class="line"><span style="color:#E1E4E8;">	i.store.</span><span style="color:#79B8FF;">updateLastBlock</span><span style="color:#E1E4E8;">(headers[</span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(headers)</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].Number)</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">func</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Ibft) </span><span style="color:#6F42C1;">processHeaders</span><span style="color:#24292E;">(headers []</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">types.Header) </span><span style="color:#D73A49;">error</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(headers) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	parentSnap, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> i.</span><span style="color:#005CC5;">getSnapshot</span><span style="color:#24292E;">(headers[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].Number </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">	snap </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> parentSnap.</span><span style="color:#005CC5;">Copy</span><span style="color:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	saveSnap </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">func</span><span style="color:#24292E;">(h </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">types.Header) </span><span style="color:#D73A49;">error</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> snap.</span><span style="color:#005CC5;">Equal</span><span style="color:#24292E;">(parentSnap) {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		snap.Number </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> h.Number</span></span>
<span class="line"><span style="color:#24292E;">		snap.Hash </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> h.Hash.</span><span style="color:#005CC5;">String</span><span style="color:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		i.store.</span><span style="color:#005CC5;">add</span><span style="color:#24292E;">(snap)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		parentSnap </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> snap</span></span>
<span class="line"><span style="color:#24292E;">		snap </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parentSnap.</span><span style="color:#005CC5;">Copy</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> _, h </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">range</span><span style="color:#24292E;"> headers {</span></span>
<span class="line"><span style="color:#24292E;">		number </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> h.Number</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		validator, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ecrecoverFromHeader</span><span style="color:#24292E;">(h)</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">snap.Set.</span><span style="color:#005CC5;">Includes</span><span style="color:#24292E;">(validator) {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;unauthroized validator&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> number</span><span style="color:#D73A49;">%</span><span style="color:#24292E;">i.epochSize </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// during a checkpoint block, we reset the voles</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// and there cannot be any proposals</span></span>
<span class="line"><span style="color:#24292E;">			snap.Votes </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">saveSnap</span><span style="color:#24292E;">(h); err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// remove in-memory snaphots from two epochs before this one</span></span>
<span class="line"><span style="color:#24292E;">			epoch </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">(number</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">i.epochSize) </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> epoch </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				purgeBlock </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">uint64</span><span style="color:#24292E;">(epoch) </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> i.epochSize</span></span>
<span class="line"><span style="color:#24292E;">				i.store.</span><span style="color:#005CC5;">deleteLower</span><span style="color:#24292E;">(purgeBlock)</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">continue</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">// if we have a miner address, this might be a vote</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> h.Miner </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> types.ZeroAddress {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">continue</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">// the nonce selects the action</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> authorize </span><span style="color:#D73A49;">bool</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> h.Nonce </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> nonceAuthVote {</span></span>
<span class="line"><span style="color:#24292E;">			authorize </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">		} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> h.Nonce </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> nonceDropVote {</span></span>
<span class="line"><span style="color:#24292E;">			authorize </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#24292E;">		} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;incorrect vote nonce&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">// validate the vote</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> authorize {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// we can only authorize if they are not on the validators list</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> snap.Set.</span><span style="color:#005CC5;">Includes</span><span style="color:#24292E;">(h.Miner) {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">continue</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// we can only remove if they are part of the validators list</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">snap.Set.</span><span style="color:#005CC5;">Includes</span><span style="color:#24292E;">(h.Miner) {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">continue</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		count </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> snap.</span><span style="color:#005CC5;">Count</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">func</span><span style="color:#24292E;">(v </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Vote) </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> v.Validator </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> validator </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> v.Address </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> h.Miner</span></span>
<span class="line"><span style="color:#24292E;">		})</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> count </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// there can only be one vote per validator per address</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> fmt.</span><span style="color:#005CC5;">Errorf</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;more than one proposal per validator per address found&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> count </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// cast the new vote since there is no one yet</span></span>
<span class="line"><span style="color:#24292E;">			snap.Votes </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">append</span><span style="color:#24292E;">(snap.Votes, </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">Vote{</span></span>
<span class="line"><span style="color:#24292E;">				Validator: validator,</span></span>
<span class="line"><span style="color:#24292E;">				Address:   h.Miner,</span></span>
<span class="line"><span style="color:#24292E;">				Authorize: authorize,</span></span>
<span class="line"><span style="color:#24292E;">			})</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">// check the tally for the proposed validator</span></span>
<span class="line"><span style="color:#24292E;">		tally </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> snap.</span><span style="color:#005CC5;">Count</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">func</span><span style="color:#24292E;">(v </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Vote) </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> v.Address </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> h.Miner</span></span>
<span class="line"><span style="color:#24292E;">		})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> tally </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> snap.Set.</span><span style="color:#005CC5;">Len</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> authorize {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#6A737D;">// add the proposal to the validator list</span></span>
<span class="line"><span style="color:#24292E;">				snap.Set.</span><span style="color:#005CC5;">Add</span><span style="color:#24292E;">(h.Miner)</span></span>
<span class="line"><span style="color:#24292E;">			} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#6A737D;">// remove the proposal from the validators list</span></span>
<span class="line"><span style="color:#24292E;">				snap.Set.</span><span style="color:#005CC5;">Del</span><span style="color:#24292E;">(h.Miner)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#6A737D;">// remove any votes casted by the removed validator</span></span>
<span class="line"><span style="color:#24292E;">				snap.</span><span style="color:#005CC5;">RemoveVotes</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">func</span><span style="color:#24292E;">(v </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Vote) </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">					</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> v.Validator </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> h.Miner</span></span>
<span class="line"><span style="color:#24292E;">				})</span></span>
<span class="line"><span style="color:#24292E;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// remove all the votes that promoted this validator</span></span>
<span class="line"><span style="color:#24292E;">			snap.</span><span style="color:#005CC5;">RemoveVotes</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">func</span><span style="color:#24292E;">(v </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Vote) </span><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">				</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> v.Address </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> h.Miner</span></span>
<span class="line"><span style="color:#24292E;">			})</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">saveSnap</span><span style="color:#24292E;">(h); err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// update the metadata</span></span>
<span class="line"><span style="color:#24292E;">	i.store.</span><span style="color:#005CC5;">updateLastBlock</span><span style="color:#24292E;">(headers[</span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(headers)</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].Number)</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>This method is usually called with 1 header, but the flow is the same even with multiple headers. <br> For each passed-in header, IBFT needs to verify that the proposer of the header is the validator. This can be done easily by grabbing the latest snapshot, and checking if the node is in the validator set.</p><p>Next, the nonce is checked. The vote is included, and tallied - and if there are enough votes a node is added/removed from the validator set, following which the new snapshot is saved.</p><h4 id="snapshot-store" tabindex="-1">Snapshot Store <a class="header-anchor" href="#snapshot-store" aria-label="Permalink to &quot;Snapshot Store&quot;">​</a></h4><p>The snapshot service manages and updates an entity called the <strong>snapshotStore</strong>, which stores the list of all available snapshots. Using it, the service is able to quickly figure out which snapshot is associated with which block height.</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">snapshotStore</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	lastNumber </span><span style="color:#F97583;">uint64</span></span>
<span class="line"><span style="color:#E1E4E8;">	lock       sync.Mutex</span></span>
<span class="line"><span style="color:#E1E4E8;">	list       snapshotSortedList</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">snapshotStore</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">struct</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	lastNumber </span><span style="color:#D73A49;">uint64</span></span>
<span class="line"><span style="color:#24292E;">	lock       sync.Mutex</span></span>
<span class="line"><span style="color:#24292E;">	list       snapshotSortedList</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="ibft-startup" tabindex="-1">IBFT Startup <a class="header-anchor" href="#ibft-startup" aria-label="Permalink to &quot;IBFT Startup&quot;">​</a></h3><p>To start up IBFT, Lyfebloc Network firstly needs to set up the IBFT transport:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Ibft) </span><span style="color:#B392F0;">setupTransport</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// use a gossip protocol</span></span>
<span class="line"><span style="color:#E1E4E8;">	topic, err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> i.network.</span><span style="color:#79B8FF;">NewTopic</span><span style="color:#E1E4E8;">(ibftProto, </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">proto.MessageReq{})</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	err </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> topic.</span><span style="color:#79B8FF;">Subscribe</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">func</span><span style="color:#E1E4E8;">(obj </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;">{}) {</span></span>
<span class="line"><span style="color:#E1E4E8;">		msg </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> obj.(</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">proto.MessageReq)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">i.</span><span style="color:#79B8FF;">isSealing</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// if we are not sealing we do not care about the messages</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// but we need to subscribe to propagate the messages</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">// decode sender</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">validateMsg</span><span style="color:#E1E4E8;">(msg); err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">			i.logger.</span><span style="color:#79B8FF;">Error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;failed to validate msg&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;err&quot;</span><span style="color:#E1E4E8;">, err)</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> msg.From </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> i.validatorKeyAddr.</span><span style="color:#79B8FF;">String</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// we are the sender, skip this message since we already</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">// relay our own messages internally.</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">		i.</span><span style="color:#79B8FF;">pushMessage</span><span style="color:#E1E4E8;">(msg)</span></span>
<span class="line"><span style="color:#E1E4E8;">	})</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> err</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	i.transport </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">gossipTransport{topic: topic}</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">func</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Ibft) </span><span style="color:#6F42C1;">setupTransport</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">error</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// use a gossip protocol</span></span>
<span class="line"><span style="color:#24292E;">	topic, err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> i.network.</span><span style="color:#005CC5;">NewTopic</span><span style="color:#24292E;">(ibftProto, </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">proto.MessageReq{})</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	err </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> topic.</span><span style="color:#005CC5;">Subscribe</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">func</span><span style="color:#24292E;">(obj </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;">{}) {</span></span>
<span class="line"><span style="color:#24292E;">		msg </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> obj.(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">proto.MessageReq)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">i.</span><span style="color:#005CC5;">isSealing</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// if we are not sealing we do not care about the messages</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// but we need to subscribe to propagate the messages</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">// decode sender</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">validateMsg</span><span style="color:#24292E;">(msg); err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">			i.logger.</span><span style="color:#005CC5;">Error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;failed to validate msg&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;err&quot;</span><span style="color:#24292E;">, err)</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> msg.From </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> i.validatorKeyAddr.</span><span style="color:#005CC5;">String</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// we are the sender, skip this message since we already</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">// relay our own messages internally.</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">		i.</span><span style="color:#005CC5;">pushMessage</span><span style="color:#24292E;">(msg)</span></span>
<span class="line"><span style="color:#24292E;">	})</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> err </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> err</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	i.transport </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">gossipTransport{topic: topic}</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>It essentially creates a new topic with IBFT proto, with a new proto buff message.<br> The messages are meant to be used by validators. Lyfebloc Network then subscribes to the topic and handles messages accordingly.</p><h4 id="messagereq" tabindex="-1">MessageReq <a class="header-anchor" href="#messagereq" aria-label="Permalink to &quot;MessageReq&quot;">​</a></h4><p>The message exchanged by validators:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">message MessageReq {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// type is the type of the message</span></span>
<span class="line"><span style="color:#E1E4E8;">    Type type </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// from is the address of the sender</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> from </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// seal is the committed seal if message is commit</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> seal </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// signature is the crypto signature of the message</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> signature </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// view is the view assigned to the message</span></span>
<span class="line"><span style="color:#E1E4E8;">    View view </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// hash of the locked block</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;"> digest </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// proposal is the rlp encoded block in preprepare messages</span></span>
<span class="line"><span style="color:#E1E4E8;">    google.protobuf.Any proposal </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">7</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    enum Type {</span></span>
<span class="line"><span style="color:#E1E4E8;">        Preprepare </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        Prepare </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        Commit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        RoundChange </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">message View {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">uint64</span><span style="color:#E1E4E8;"> round </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">uint64</span><span style="color:#E1E4E8;"> sequence </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">message MessageReq {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// type is the type of the message</span></span>
<span class="line"><span style="color:#24292E;">    Type type </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// from is the address of the sender</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> from </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// seal is the committed seal if message is commit</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> seal </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// signature is the crypto signature of the message</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> signature </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// view is the view assigned to the message</span></span>
<span class="line"><span style="color:#24292E;">    View view </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// hash of the locked block</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">string</span><span style="color:#24292E;"> digest </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// proposal is the rlp encoded block in preprepare messages</span></span>
<span class="line"><span style="color:#24292E;">    google.protobuf.Any proposal </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">7</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    enum Type {</span></span>
<span class="line"><span style="color:#24292E;">        Preprepare </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        Prepare </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        Commit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        RoundChange </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">message View {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">uint64</span><span style="color:#24292E;"> round </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">uint64</span><span style="color:#24292E;"> sequence </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>The <strong>View</strong> field in the <strong>MessageReq</strong> represents the current node position inside the chain. It has a <em>round</em>, and a <em>sequence</em> attribute.</p><ul><li><strong>round</strong> represents the proposer round for the height</li><li><strong>sequence</strong> represents the height of the blockchain</li></ul><p>The <em>msgQueue</em> filed in the IBFT implementation has the purpose of storing message requests. It orders messages by the <em>View</em> (firstly by sequence, then by round). The IBFT implementation also possesses different queues for different states in the system.</p><h3 id="ibft-states" tabindex="-1">IBFT States <a class="header-anchor" href="#ibft-states" aria-label="Permalink to &quot;IBFT States&quot;">​</a></h3><p>After the consensus mechanism is started using the <strong>Start</strong> method, it runs into an infinite loop which simulates a state machine:</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Ibft) </span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// consensus always starts in SyncState mode in case it needs</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// to sync with other nodes.</span></span>
<span class="line"><span style="color:#E1E4E8;">	i.</span><span style="color:#79B8FF;">setState</span><span style="color:#E1E4E8;">(SyncState)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	header </span><span style="color:#F97583;">:=</span><span style="color:#E1E4E8;"> i.blockchain.</span><span style="color:#79B8FF;">Header</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">	i.logger.</span><span style="color:#79B8FF;">Debug</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;current sequence&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;sequence&quot;</span><span style="color:#E1E4E8;">, header.Number</span><span style="color:#F97583;">+</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;-</span><span style="color:#E1E4E8;">i.closeCh:</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">		i.</span><span style="color:#79B8FF;">runCycle</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">Ibft) </span><span style="color:#B392F0;">runCycle</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> i.state.view </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">		i.logger.</span><span style="color:#79B8FF;">Debug</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">		    </span><span style="color:#9ECBFF;">&quot;cycle&quot;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#E1E4E8;">		    </span><span style="color:#9ECBFF;">&quot;state&quot;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#E1E4E8;">		    i.</span><span style="color:#79B8FF;">getState</span><span style="color:#E1E4E8;">(), </span></span>
<span class="line"><span style="color:#E1E4E8;">		    </span><span style="color:#9ECBFF;">&quot;sequence&quot;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#E1E4E8;">		    i.state.view.Sequence, </span></span>
<span class="line"><span style="color:#E1E4E8;">		    </span><span style="color:#9ECBFF;">&quot;round&quot;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#E1E4E8;">		    i.state.view.Round,</span></span>
<span class="line"><span style="color:#E1E4E8;">	    )</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">switch</span><span style="color:#E1E4E8;"> i.</span><span style="color:#79B8FF;">getState</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> AcceptState:</span></span>
<span class="line"><span style="color:#E1E4E8;">		i.</span><span style="color:#79B8FF;">runAcceptState</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> ValidateState:</span></span>
<span class="line"><span style="color:#E1E4E8;">		i.</span><span style="color:#79B8FF;">runValidateState</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> RoundChangeState:</span></span>
<span class="line"><span style="color:#E1E4E8;">		i.</span><span style="color:#79B8FF;">runRoundChangeState</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> SyncState:</span></span>
<span class="line"><span style="color:#E1E4E8;">		i.</span><span style="color:#79B8FF;">runSyncState</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">func</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Ibft) </span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// consensus always starts in SyncState mode in case it needs</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// to sync with other nodes.</span></span>
<span class="line"><span style="color:#24292E;">	i.</span><span style="color:#005CC5;">setState</span><span style="color:#24292E;">(SyncState)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	header </span><span style="color:#D73A49;">:=</span><span style="color:#24292E;"> i.blockchain.</span><span style="color:#005CC5;">Header</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">	i.logger.</span><span style="color:#005CC5;">Debug</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;current sequence&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;sequence&quot;</span><span style="color:#24292E;">, header.Number</span><span style="color:#D73A49;">+</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;-</span><span style="color:#24292E;">i.closeCh:</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">default</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">		i.</span><span style="color:#005CC5;">runCycle</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">func</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">Ibft) </span><span style="color:#6F42C1;">runCycle</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> i.state.view </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">nil</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">		i.logger.</span><span style="color:#005CC5;">Debug</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">		    </span><span style="color:#032F62;">&quot;cycle&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line"><span style="color:#24292E;">		    </span><span style="color:#032F62;">&quot;state&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line"><span style="color:#24292E;">		    i.</span><span style="color:#005CC5;">getState</span><span style="color:#24292E;">(), </span></span>
<span class="line"><span style="color:#24292E;">		    </span><span style="color:#032F62;">&quot;sequence&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line"><span style="color:#24292E;">		    i.state.view.Sequence, </span></span>
<span class="line"><span style="color:#24292E;">		    </span><span style="color:#032F62;">&quot;round&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line"><span style="color:#24292E;">		    i.state.view.Round,</span></span>
<span class="line"><span style="color:#24292E;">	    )</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">switch</span><span style="color:#24292E;"> i.</span><span style="color:#005CC5;">getState</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> AcceptState:</span></span>
<span class="line"><span style="color:#24292E;">		i.</span><span style="color:#005CC5;">runAcceptState</span><span style="color:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> ValidateState:</span></span>
<span class="line"><span style="color:#24292E;">		i.</span><span style="color:#005CC5;">runValidateState</span><span style="color:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> RoundChangeState:</span></span>
<span class="line"><span style="color:#24292E;">		i.</span><span style="color:#005CC5;">runRoundChangeState</span><span style="color:#24292E;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> SyncState:</span></span>
<span class="line"><span style="color:#24292E;">		i.</span><span style="color:#005CC5;">runSyncState</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h4 id="syncstate" tabindex="-1">SyncState <a class="header-anchor" href="#syncstate" aria-label="Permalink to &quot;SyncState&quot;">​</a></h4><p>All nodes initially start in the <strong>Sync</strong> state.</p><p>This is because fresh data needs to be fetched from the blockchain. The client needs to find out if it&#39;s the validator, find the current snapshot. This state resolves any pending blocks.</p><p>After the sync finishes, and the client determines it is indeed a validator, it needs to transfer to <strong>AcceptState</strong>. If the client is <strong>not</strong> a validator, it will continue syncing, and stay in <strong>SyncState</strong></p><h4 id="acceptstate" tabindex="-1">AcceptState <a class="header-anchor" href="#acceptstate" aria-label="Permalink to &quot;AcceptState&quot;">​</a></h4><p>The <strong>Accept</strong> state always check the snapshot and the validator set. If the current node is not in the validators set, it moves back to the <strong>Sync</strong> state.</p><p>On the other hand, if the node <strong>is</strong> a validator, it calculates the proposer. If it turns out that the current node is the proposer, it builds a block, and sends preprepare and then prepare messages.</p><ul><li>Preprepare messages - messages sent by proposers to validators, to let them know about the proposal</li><li>Prepare messages - messages where validators agree on a proposal. All nodes receive all prepare messages</li><li>Commit messages - messages containing commit information for the proposal</li></ul><p>If the current node <strong>is not</strong> a validator, it uses the <em>getNextMessage</em> method to read a message from the previously shown queue. <br> It waits for the preprepare messages. Once it is confirmed everything is correct, the node moves to the <strong>Validate</strong> state.</p><h4 id="validatestate" tabindex="-1">ValidateState <a class="header-anchor" href="#validatestate" aria-label="Permalink to &quot;ValidateState&quot;">​</a></h4><p>The <strong>Validate</strong> state is rather simple - all nodes do in this state is read messages and add them to their local snapshot state.</p></div></div></main><footer class="VPDocFooter" data-v-a3c25e27 data-v-a2d931e4><!--[--><!--]--><div class="edit-info" data-v-a2d931e4><!----><div class="last-updated" data-v-a2d931e4><p class="VPLastUpdated" data-v-a2d931e4 data-v-19a7ae4e>Last updated: <time datetime="2025-02-16T18:12:37.000Z" data-v-19a7ae4e></time></p></div></div><nav class="prev-next" data-v-a2d931e4><div class="pager" data-v-a2d931e4><a class="pager-link prev" href="/architecture/blockchain" data-v-a2d931e4><span class="desc" data-v-a2d931e4>Previous page</span><span class="title" data-v-a2d931e4>Blockchain</span></a></div><div class="pager" data-v-a2d931e4><a class="pager-link next" href="/architecture/protocol" data-v-a2d931e4><span class="desc" data-v-a2d931e4>Next page</span><span class="title" data-v-a2d931e4>Protocol</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"architecture_protocol.md\":\"8d87526c\",\"architecture_networking.md\":\"322f7093\",\"security.md\":\"1f57c7f0\",\"architecture_other.md\":\"3ca5b8b0\",\"architecture_overview.md\":\"d82e0a1a\",\"architecture_blockchain.md\":\"999abcb7\",\"architecture_minimal.md\":\"ea4e505b\",\"concepts_evm.md\":\"3edef6a1\",\"concepts_evm-state.md\":\"293e30d4\",\"get-started_api-docs.md\":\"f5ce2558\",\"architecture_state.md\":\"d61a1271\",\"get-started_private-keys.md\":\"94dea5ff\",\"index.md\":\"b83a1de7\",\"get-started_validator-node.md\":\"fcb3994a\",\"get-started_consensus-node.md\":\"52f3cbf0\",\"get-started_installation.md\":\"611c46e4\",\"overview_how-to-stake-lyb.md\":\"550d4f7f\",\"performance-reports_stress-testing.md\":\"92eb0faa\",\"performance-reports_overview.md\":\"31547a56\",\"get-started_json-rpc.md\":\"254fbf89\",\"get-started_environment.md\":\"fb22d7b3\",\"get-started_lyfebloc-node.md\":\"17f513c2\",\"get-started_mainnet.md\":\"ddf6b9ad\",\"get-started_operator-information.md\":\"680877f6\",\"get-started_metrics.md\":\"6acfbee4\",\"get-started_rpc-commands.md\":\"295a9a29\",\"architecture_storage.md\":\"45a95526\",\"get-started_cloud-setup.md\":\"dec6fa4d\",\"overview_staking.md\":\"ec05bed1\",\"overview_introduction.md\":\"f215cea7\",\"readme.md\":\"2c77c56c\",\"get-started_pos-setup.md\":\"20f4fefd\",\"architecture_consensus.md\":\"659bcfce\",\"get-started_backup-restore.md\":\"4ce2234a\",\"get-started_nodes-overview.md\":\"6df98fc9\",\"overview_lyb.md\":\"90cd41d1\",\"architecture_types.md\":\"015bef78\",\"architecture_sealer.md\":\"39bb9e28\",\"get-started_pos-concepts.md\":\"88697b4f\",\"architecture_json-rpc.md\":\"a883bb1c\",\"architecture_txpool.md\":\"aa6d4cfb\",\"get-started_cli-commands.md\":\"7443a9cc\"}");function deserializeFunctions(r){return Array.isArray(r)?r.map(deserializeFunctions):typeof r=="object"&&r!==null?Object.keys(r).reduce((t,n)=>(t[n]=deserializeFunctions(r[n]),t),{}):typeof r=="string"&&r.startsWith("_vp-fn_")?new Function(`return ${r.slice(7)}`)():r};window.__VP_SITE_DATA__=deserializeFunctions(JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Lyfebloc Docs\",\"description\":\"Highly scalable modular blockchain powering dynamic applications with extensive full-stack adaptability.\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Join the network\",\"items\":[{\"text\":\"Overview\",\"link\":\"/overview/introduction\"},{\"text\":\"Installation\",\"link\":\"/get-started/installation\"},{\"text\":\"Resources\",\"items\":[{\"text\":\"Lyfebloc Network Explorer\",\"link\":\"https://lyfeblocscan.com/\"},{\"text\":\"lyfebloc-core API docs\",\"link\":\"get-started/api-docs\"}]}]}],\"outline\":{\"level\":\"deep\"},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"sidebar\":{\"/\":[{\"text\":\"Overview\",\"collapsed\":true,\"items\":[{\"text\":\"Network Overview\",\"collapsed\":true,\"items\":[{\"text\":\"Introduction\",\"link\":\"overview/introduction\"}]},{\"text\":\"LYB\",\"collapsed\":true,\"items\":[{\"text\":\"Overview of LYB\",\"link\":\"/overview/lyb\"},{\"text\":\"How to stake LYB\",\"link\":\"/overview/how-to-stake-lyb\"},{\"text\":\"Staking dashboards\",\"link\":\"/overview/staking\"}]}]},{\"text\":\"How-to guides\",\"collapsed\":true,\"items\":[{\"text\":\"Run a Node\",\"collapsed\":true,\"items\":[{\"text\":\"Getting Started\",\"collapsed\":true,\"items\":[{\"text\":\"Installation\",\"link\":\"get-started/installation\"},{\"text\":\"Local Setup\",\"link\":\"/get-started/environment\"},{\"text\":\"Cloud Setup\",\"link\":\"/get-started/cloud-setup\"},{\"text\":\"CLI Commands\",\"link\":\"/get-started/cli-commands\"},{\"text\":\"RPC Commands\",\"link\":\"/get-started/rpc-commands\"}]},{\"text\":\"Network Endpoints\",\"collapsed\":true,\"items\":[{\"text\":\"JSON RPC\",\"link\":\"/get-started/json-rpc\"},{\"text\":\"Operator Info\",\"link\":\"/get-started/operator-information\"},{\"text\":\"Backup/Restore\",\"link\":\"/get-started/backup-restore\"}]},{\"text\":\"Consensus\",\"collapsed\":true,\"items\":[{\"text\":\"Lyfebloc Proof of Stake (POS)\",\"collapsed\":true,\"items\":[{\"text\":\"POS Concepts\",\"link\":\"/get-started/pos-concepts\"},{\"text\":\"POS Contract Setup\",\"link\":\"/get-started/pos-setup\"}]}]}]},{\"text\":\"Configuration\",\"collapsed\":true,\"items\":[{\"text\":\"Server Config File\",\"link\":\"get-started/sample-config.md\"},{\"text\":\"Manage private keys\",\"link\":\"get-started/private-keys.md\"},{\"text\":\"Enable Metrics\",\"link\":\"get-started/metrics.md\"}]}]},{\"text\":\"Architecture\",\"collapsed\":true,\"items\":[{\"text\":\"Overview\",\"collapsed\":true,\"items\":[{\"text\":\"Overview\",\"link\":\"/architecture/overview\"}]},{\"text\":\"Modules\",\"collapsed\":true,\"items\":[{\"text\":\"Blockchain\",\"link\":\"/architecture/blockchain\"},{\"text\":\"Consensus\",\"link\":\"/architecture/consensus\"},{\"text\":\"Protocol\",\"link\":\"/architecture/protocol\"},{\"text\":\"Minimal\",\"link\":\"/architecture/minimal\"},{\"text\":\"Networking\",\"link\":\"/architecture/networking\"},{\"text\":\"JSON RPC\",\"link\":\"/architecture/json-rpc\"},{\"text\":\"Sealer\",\"link\":\"/architecture/sealer\"},{\"text\":\"Storage\",\"link\":\"/architecture/storage\"},{\"text\":\"Types\",\"link\":\"/architecture/types\"},{\"text\":\"TxPool\",\"link\":\"/architecture/txpool\"},{\"text\":\"Other Modules\",\"link\":\"/architecture/other\"}]}]},{\"text\":\"Concepts\",\"collapsed\":true,\"items\":[{\"text\":\"EVM\",\"link\":\"/concepts/evm\"},{\"text\":\"EVM State\",\"link\":\"/concepts/evm-state\"}]},{\"text\":\"Performance Reports\",\"collapsed\":true,\"items\":[{\"text\":\"Overview\",\"link\":\"performance-reports/overview\"},{\"text\":\"Testing\",\"link\":\"performance-reports/stress-testing\"},{\"text\":\"EVM State\",\"link\":\"/concepts/evm-state\"}]}]},\"logo\":{\"alt\":\"Lyfebloc Logo\",\"light\":\"/logo-light.svg\",\"dark\":\"/logo-dark.svg\"},\"siteTitle\":false,\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/lyfeblocnetwork/docs\"},{\"icon\":\"twitter\",\"link\":\"https://twitter.com/LyfeblocNetwork\"},{\"icon\":\"discord\",\"link\":\"https://discord.com\"},{\"icon\":{\"svg\":\" <svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n<path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12ZM12.43 8.85893C11.2628 9.3444 8.93014 10.3492 5.43189 11.8733C4.86383 12.0992 4.56626 12.3202 4.53917 12.5363C4.49339 12.9015 4.95071 13.0453 5.57347 13.2411C5.65818 13.2678 5.74595 13.2954 5.83594 13.3246C6.44864 13.5238 7.27283 13.7568 7.70129 13.766C8.08994 13.7744 8.52373 13.6142 9.00264 13.2853C12.2712 11.079 13.9584 9.96381 14.0643 9.93977C14.139 9.92281 14.2426 9.90148 14.3128 9.96385C14.3829 10.0262 14.376 10.1443 14.3686 10.176C14.3233 10.3691 12.5281 12.0381 11.5991 12.9018C11.3095 13.171 11.1041 13.362 11.0621 13.4056C10.968 13.5033 10.8721 13.5958 10.78 13.6846C10.2108 14.2333 9.78391 14.6448 10.8036 15.3168C11.2936 15.6397 11.6858 15.9067 12.077 16.1731C12.5042 16.4641 12.9303 16.7543 13.4816 17.1157C13.6221 17.2077 13.7562 17.3034 13.8869 17.3965C14.3841 17.751 14.8307 18.0694 15.3826 18.0186C15.7032 17.9891 16.0345 17.6876 16.2027 16.7884C16.6002 14.6631 17.3816 10.0585 17.5622 8.16097C17.578 7.99473 17.5581 7.78197 17.5422 7.68857C17.5262 7.59518 17.4928 7.46211 17.3714 7.3636C17.2276 7.24694 17.0056 7.22234 16.9064 7.22408C16.455 7.23203 15.7626 7.47282 12.43 8.85893Z\\\" fill=\\\"currentColor\\\"/>\\n</svg>\"},\"link\":\"https://t.me\"}],\"transformHead\":\"_vp-fn_function(assets) {\\n      const youthRegularFont = assets.find(\\n        (file) => /youth\\\\/Youth-Regular\\\\.\\\\w+\\\\.woff2/\\n      );\\n      const untitledSansRegularFont = assets.find(\\n        (file) => /Untitled-Sans-Regular\\\\.\\\\w+\\\\.woff2/\\n      );\\n      const untitledSansMediumFont = assets.find(\\n        (file) => /Unititled-Sans-Medium\\\\.\\\\w+\\\\.woff2/\\n      );\\n      const headConfig = [];\\n      if (youthRegularFont) {\\n        headConfig.push([\\n          \\\"link\\\",\\n          {\\n            rel: \\\"preload\\\",\\n            href: youthRegularFont,\\n            as: \\\"font\\\",\\n            type: \\\"font/woff2\\\",\\n            crossorigin: \\\"\\\"\\n          }\\n        ]);\\n      }\\n      if (untitledSansRegularFont) {\\n        headConfig.push([\\n          \\\"link\\\",\\n          {\\n            rel: \\\"preload\\\",\\n            href: untitledSansRegularFont,\\n            as: \\\"font\\\",\\n            type: \\\"font/woff2\\\",\\n            crossorigin: \\\"\\\"\\n          }\\n        ]);\\n      }\\n      if (untitledSansMediumFont) {\\n        headConfig.push([\\n          \\\"link\\\",\\n          {\\n            rel: \\\"preload\\\",\\n            href: untitledSansMediumFont,\\n            as: \\\"font\\\",\\n            type: \\\"font/woff2\\\",\\n            crossorigin: \\\"\\\"\\n          }\\n        ]);\\n      }\\n      return headConfig;\\n    }\"},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":true}"));</script>
    
  </body>
</html>